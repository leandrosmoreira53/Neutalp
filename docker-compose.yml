version: '3.8'

services:
  vault-deployer:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: deltaneutral-vault
    volumes:
      # Monta o código (para desenvolvimento)
      - .:/app
      # Persiste node_modules
      - node_modules:/app/node_modules
      # Persiste artifacts e cache
      - artifacts:/app/artifacts
      - cache:/app/cache
    environment:
      # Variáveis do .env serão carregadas automaticamente
      - PRIVATE_KEY=${PRIVATE_KEY}
      - ARBITRUM_SEPOLIA_RPC_URL=${ARBITRUM_SEPOLIA_RPC_URL}
      - ALCHEMY_API_KEY=${ALCHEMY_API_KEY:-}
      - ETHERSCAN_API_KEY=${ETHERSCAN_API_KEY:-}
      - ARBISCAN_API_KEY=${ARBISCAN_API_KEY:-}
    env_file:
      - .env
    stdin_open: true
    tty: true
    command: bash

volumes:
  node_modules:
  artifacts:
  cache:
